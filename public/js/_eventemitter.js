var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1));function EE(a,c,d){this.fn=a;this.context=c;this.once=d||!1}function addListener(a,c,d,g,f){d=new EE(d,g||a,f);c=prefix?prefix+c:c;a._events[c]?a._events[c].fn?a._events[c]=[a._events[c],d]:a._events[c].push(d):(a._events[c]=d,a._eventsCount++);return a}
function clearEvent(a,c){0===--a._eventsCount?a._events=new Events:delete a._events[c]}function EventEmitter(){this._events=new Events;this._eventsCount=0}EventEmitter.prototype.eventNames=function(){var a=[],c,d;if(0===this._eventsCount)return a;for(d in c=this._events)has.call(c,d)&&a.push(prefix?d.slice(1):d);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(c)):a};
EventEmitter.prototype.listeners=function(a,c){var d=this._events[prefix?prefix+a:a];if(c)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var g=0,f=d.length,h=Array(f);g<f;g++)h[g]=d[g].fn;return h};
EventEmitter.prototype.emit=function(a,c,d,g,f,h){var b=prefix?prefix+a:a;if(!this._events[b])return!1;var b=this._events[b],k=arguments.length,l;if(b.fn){b.once&&this.removeListener(a,b.fn,void 0,!0);switch(k){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,c),!0;case 3:return b.fn.call(b.context,c,d),!0;case 4:return b.fn.call(b.context,c,d,g),!0;case 5:return b.fn.call(b.context,c,d,g,f),!0;case 6:return b.fn.call(b.context,c,d,g,f,h),!0}var e=1;for(l=Array(k-1);e<k;e++)l[e-
1]=arguments[e];b.fn.apply(b.context,l)}else{var n=b.length;for(e=0;e<n;e++)switch(b[e].once&&this.removeListener(a,b[e].fn,void 0,!0),k){case 1:b[e].fn.call(b[e].context);break;case 2:b[e].fn.call(b[e].context,c);break;case 3:b[e].fn.call(b[e].context,c,d);break;case 4:b[e].fn.call(b[e].context,c,d,g);break;default:if(!l){var m=1;for(l=Array(k-1);m<k;m++)l[m-1]=arguments[m]}b[e].fn.apply(b[e].context,l)}}return!0};EventEmitter.prototype.on=function(a,c,d){return addListener(this,a,c,d,!1)};
EventEmitter.prototype.once=function(a,c,d){return addListener(this,a,c,d,!0)};EventEmitter.prototype.removeListener=function(a,c,d,g){a=prefix?prefix+a:a;if(!this._events[a])return this;if(!c)return clearEvent(this,a),this;var f=this._events[a];if(f.fn)f.fn!==c||g&&!f.once||d&&f.context!==d||clearEvent(this,a);else{for(var h=0,b=[],k=f.length;h<k;h++)(f[h].fn!==c||g&&!f[h].once||d&&f[h].context!==d)&&b.push(f[h]);b.length?this._events[a]=1===b.length?b[0]:b:clearEvent(this,a)}return this};
EventEmitter.prototype.removeAllListeners=function(a){a?(a=prefix?prefix+a:a,this._events[a]&&clearEvent(this,a)):(this._events=new Events,this._eventsCount=0);return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.setMaxListeners=function(){return this};EventEmitter.prefixed=prefix;EventEmitter.EventEmitter=EventEmitter;"undefined"!==typeof module&&(module.exports=EventEmitter);
